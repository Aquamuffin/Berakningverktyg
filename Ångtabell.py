import math
import numpy as np


def getSteamDens(P):
    pressures = np.array([0.95,1,1.5,2,2.5,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,24,26,28,30,32,34,36,38,40,42,44,46,48,50,60,70,80,90,100,110,120,130,140,150,200,221],dtype=float)
    dens= 1/1000*np.array([0.5618,0.5903,0.8628,1.1296,1.392,1.6513,2.1631,2.6688,3.1696,3.667,4.1615,4.6555,5.1467,5.637,6.1275,6.6181,7.1073,7.5988,8.0841,8.5763,9.0662,9.5602,10.0482,10.5396,11.0327,12.0207,13.0124,14.0076,15.0083,16.0154,17.0271,18.0440,19.0694,20.1001,21.1372,22.1828,22.57132,24.2954,25.3614,30.8261,36.5363,42.4989,48.7805,55.4324,62.461,70.028,78.125,86.9565,96.7118,175.8396,315.4574],dtype=float)

    for i in range(0,51):
        if P <= pressures[i] and i>0:
            t1 = pressures[i]
            t2 = pressures[i-1]
            k = (P-t2)/(t1-t2)
            return k*dens[i]+(1-k)*dens[i-1]
        if P <= pressures[i] and i==0:
            return dens[i]
    return 1000000

def getAirDens(P,T):
    baseDens = 1/1000*1.2921 
    return baseDens*273/(T+273)*P

def VapourizationPressure(T):
    vaporTemps = np.array([0,5,10,15,20,25,30,35,40,45,50,55,60,65,70,75,80,85,90,95,100,110,120,130,140,150,160,170,180,190,200]) 
    vaporPressures = 1/101.42*np.array([0.61,0.87,1.23,1.71,2.34,3.17,4.25,5.63,7.38,9.59,12.34,15.75,19.93,25.02,31.18,38.56,47.37,57.82,70.12,84.53,101.42,143.38,198.67,270.26,361.5,476.1,618.14,792.05,1002.6,1255,1554.7])

    for i in range(0,21):
        if T <= vaporTemps[i] and i>0:
            t1 = vaporTemps[i]
            t2 = vaporTemps[i-1]
            k = (T-t2)/(t1-t2)
            return k*vaporPressures[i]+vaporPressures[i-1]*(1-k)
        if T <= vaporTemps[i] and i==0:
            return vaporPressures[i]
    return 1000000